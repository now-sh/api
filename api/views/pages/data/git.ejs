<div class="v-100">
  <h1 class="text-danger">ðŸ“Š GitHub Repository Data</h1>
  <p class="lead">View GitHub user information and repositories</p>

  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card border border-danger">
        <div class="card-header">
          <h5 class="mb-0">GitHub User Lookup</h5>
        </div>
        <div class="card-body">
          <form id="gitForm">
            <div class="mb-3">
              <label for="username" class="form-label">GitHub Username</label>
              <input type="text" class="form-control" id="username" name="username" value="casjay" placeholder="Enter GitHub username...">
            </div>
            
            <div class="mb-3">
              <label for="dataType" class="form-label">Data Type</label>
              <select class="form-control" id="dataType" name="dataType">
                <option value="user">User Profile</option>
                <option value="repos">Repositories</option>
                <option value="orgs">Organizations</option>
              </select>
            </div>
            
            <button type="submit" class="btn btn-danger">
              <i class="bi bi-github"></i> Get GitHub Data
            </button>
          </form>
        </div>
      </div>
      
      <div id="gitForm-result" class="mt-4" style="display: none;">
        <div class="card border border-success">
          <div class="card-header">
            <h5 class="mb-0">GitHub Data</h5>
          </div>
          <div class="card-body">
            <div class="result-output bg-dark text-light p-3 rounded" style="max-height: 400px; overflow-y: auto; font-size: 0.875rem;"></div>
            <button class="btn btn-outline-success btn-sm mt-2" onclick="copyToClipboard('.result-output')">
              <i class="bi bi-clipboard"></i> Copy JSON
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row justify-content-center mt-5">
    <div class="col-md-8">
      <div class="card border-info">
        <div class="card-header">
          <h5 class="mb-0">API Endpoints</h5>
        </div>
        <div class="card-body">
          <ul class="list-unstyled">
            <li><strong>User Info:</strong> <code>/api/v1/git/user/:username</code></li>
            <li><strong>My Profile:</strong> <code>/api/v1/git/jason</code></li>
            <li><strong>Repositories:</strong> <code>/api/v1/git/repos/:username</code></li>
            <li><strong>Organizations:</strong> <code>/api/v1/git/orgs/:username</code></li>
          </ul>
          <a href="/api/v1/git/jason" class="btn btn-info btn-sm" target="_blank">
            <i class="bi bi-box-arrow-up-right"></i> View Casjay Profile
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<%- locals.customScripts = '<script src="/js/data-forms.js"></script>' %>

<script>
function copyToClipboard(selector) {
  const element = document.querySelector(selector);
  if (element) {
    navigator.clipboard.writeText(element.textContent);
  }
}

document.getElementById('gitForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  
  const formData = new FormData(e.target);
  const username = formData.get('username');
  const dataType = formData.get('dataType');
  const resultDiv = document.getElementById('gitForm-result');
  const resultOutput = resultDiv.querySelector('.result-output');
  
  if (!username) {
    alert('Please enter a username');
    return;
  }
  
  try {
    let endpoint;
    if (dataType === 'user') {
      endpoint = username === 'casjay' ? '/api/v1/git/jason' : `/api/v1/git/user/${username}`;
    } else if (dataType === 'repos') {
      endpoint = `/api/v1/git/repos/${username}`;
    } else if (dataType === 'orgs') {
      endpoint = `/api/v1/git/orgs/${username}`;
    }
    
    const response = await fetch(endpoint);
    const data = await response.json();
    
    if (response.ok) {
      resultOutput.textContent = JSON.stringify(data, null, 2);
      resultDiv.style.display = 'block';
      resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    } else {
      resultOutput.textContent = `Error: ${data.message || 'Failed to fetch data'}`;
      resultDiv.style.display = 'block';
    }
  } catch (error) {
    resultOutput.textContent = `Error: ${error.message}`;
    resultDiv.style.display = 'block';
  }
});
</script>