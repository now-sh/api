<div class="v-100">
  <h1 class="text-danger">ðŸ“Š My Reddit Data</h1>
  <p class="lead">View my Reddit posts and activity or search other users</p>

  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card border border-danger">
        <div class="card-header">
          <h5 class="mb-0">My Reddit Profile</h5>
        </div>
        <div class="card-body">
          <% if (typeof pageData !== 'undefined' && pageData && pageData.data && pageData.data.user) { %>
            <div class="reddit-profile">
              <!-- Profile Header with Avatar -->
              <div class="profile-header">
                <% if (pageData.data.user.icon_img) { %>
                  <img src="<%- pageData.data.user.icon_img %>" alt="<%= pageData.data.user.name %>" class="profile-avatar">
                <% } %>
                <div class="profile-info">
                  <h4>
                    <%= pageData.data.user.display_name || pageData.data.user.name %>
                    <% if (pageData.data.user.verified) { %>
                      <i class="bi bi-patch-check-fill text-primary" title="Verified"></i>
                    <% } %>
                    <% if (pageData.data.user.is_gold) { %>
                      <i class="bi bi-star-fill text-warning" title="Reddit Premium"></i>
                    <% } %>
                    <% if (pageData.data.user.is_mod) { %>
                      <i class="bi bi-shield-fill text-success" title="Moderator"></i>
                    <% } %>
                  </h4>
                  <p class="text-muted">u/<%= pageData.data.user.name %></p>
                  <% if (pageData.data.user.public_description) { %>
                    <p class="profile-description"><%= pageData.data.user.public_description %></p>
                  <% } %>
                </div>
              </div>

              <!-- Account Info -->
              <div class="account-info mt-3">
                <div class="info-row">
                  <span class="info-label"><i class="bi bi-calendar"></i> Cake Day:</span>
                  <span class="info-value"><%= new Date(pageData.data.user.created_utc * 1000).toLocaleDateString() %></span>
                </div>
                <div class="info-row">
                  <span class="info-label"><i class="bi bi-person-badge"></i> Account ID:</span>
                  <span class="info-value"><%= pageData.data.user.id %></span>
                </div>
                <% if (pageData.data.user.subreddit && pageData.data.user.subreddit.subscribers) { %>
                  <div class="info-row">
                    <span class="info-label"><i class="bi bi-people"></i> Followers:</span>
                    <span class="info-value"><%= pageData.data.user.subreddit.subscribers.toLocaleString() %></span>
                  </div>
                <% } %>
                <div class="info-row">
                  <span class="info-label"><i class="bi bi-envelope-check"></i> Verified Email:</span>
                  <span class="info-value"><%= pageData.data.user.has_verified_email ? 'Yes' : 'No' %></span>
                </div>
                <% if (pageData.data.user.is_employee) { %>
                  <div class="info-row">
                    <span class="info-label"><i class="bi bi-building"></i> Reddit Employee:</span>
                    <span class="info-value text-danger">Yes</span>
                  </div>
                <% } %>
                <% if (pageData.data.user.accept_followers !== undefined) { %>
                  <div class="info-row">
                    <span class="info-label"><i class="bi bi-person-plus"></i> Accepts Followers:</span>
                    <span class="info-value"><%= pageData.data.user.accept_followers ? 'Yes' : 'No' %></span>
                  </div>
                <% } %>
                <% if (pageData.data.user.has_subscribed) { %>
                  <div class="info-row">
                    <span class="info-label"><i class="bi bi-star"></i> Has Subscriptions:</span>
                    <span class="info-value">Yes</span>
                  </div>
                <% } %>
              </div>

              <!-- Karma Breakdown -->
              <div class="reddit-stats">
                <div class="stat-card total">
                  <div class="stat-number"><%= pageData.data.user.total_karma.toLocaleString() %></div>
                  <div class="stat-label">Total Karma</div>
                </div>
                <div class="stat-card">
                  <div class="stat-number"><%= pageData.data.user.link_karma.toLocaleString() %></div>
                  <div class="stat-label">Post Karma</div>
                </div>
                <div class="stat-card">
                  <div class="stat-number"><%= pageData.data.user.comment_karma.toLocaleString() %></div>
                  <div class="stat-label">Comment Karma</div>
                </div>
                <% if (pageData.data.user.awardee_karma > 0) { %>
                  <div class="stat-card">
                    <div class="stat-number"><%= pageData.data.user.awardee_karma.toLocaleString() %></div>
                    <div class="stat-label">Awardee Karma</div>
                  </div>
                <% } %>
                <% if (pageData.data.user.awarder_karma > 0) { %>
                  <div class="stat-card">
                    <div class="stat-number"><%= pageData.data.user.awarder_karma.toLocaleString() %></div>
                    <div class="stat-label">Awarder Karma</div>
                  </div>
                <% } %>
              </div>

              <!-- Profile Banner -->
              <% if (pageData.data.user.subreddit && pageData.data.user.subreddit.banner_img) { %>
                <div class="profile-banner mt-3">
                  <img src="<%- pageData.data.user.subreddit.banner_img %>" alt="Profile Banner" class="banner-img">
                </div>
              <% } %>

              <!-- API Info -->
              <div class="reddit-info mt-3">
                <p class="text-info">
                  <i class="bi bi-info-circle"></i> <%= pageData.data.note || pageData.message %>
                </p>
                <div class="info-badges">
                  <span class="badge bg-secondary">Access: <%= pageData.data.access_level || 'read-only' %></span>
                  <% if (pageData.data.source) { %>
                    <span class="badge bg-info">Source: <%= pageData.data.source %></span>
                  <% } %>
                  <% if (pageData.data.last_updated) { %>
                    <span class="badge bg-dark">Updated: <%= new Date(pageData.data.last_updated).toLocaleTimeString() %></span>
                  <% } %>
                </div>
              </div>
            </div>
          <% } else if (typeof pageData !== 'undefined' && pageData && pageData.success === false) { %>
            <div class="error-state">
              <p class="text-danger">Error loading Reddit data</p>
              <p class="text-muted"><%= pageData.message || pageData.error || 'Unknown error' %></p>
            </div>
          <% } else if (typeof apiError !== 'undefined' && apiError) { %>
            <div class="error-state">
              <p class="text-danger">Failed to fetch Reddit data</p>
              <p class="text-muted"><%= apiError %></p>
              <p class="text-info mt-3">
                <i class="bi bi-info-circle"></i> Try visiting the API directly:
                <a href="/api/v1/me/info/reddit" target="_blank" class="text-cyan">/api/v1/me/info/reddit</a>
              </p>
            </div>
          <% } else { %>
            <div class="loading-state">
              <p class="text-danger">No Reddit data available</p>
              <p class="text-muted">Unable to load Reddit profile information</p>
              <p class="text-info mt-3">
                <i class="bi bi-info-circle"></i> This might be a configuration issue. Check the API endpoint:
                <a href="/api/v1/me/info/reddit" target="_blank" class="text-cyan">/api/v1/me/info/reddit</a>
              </p>
            </div>
          <% } %>
        </div>
      </div>
    </div>
  </div>

  <div class="row justify-content-center mt-5">
    <div class="col-md-8">
      <div class="card border-info">
        <div class="card-header">
          <h5 class="mb-0">API Endpoints</h5>
        </div>
        <div class="card-body">
          <ul class="list-unstyled">
            <li><strong>My Profile:</strong> <code>/api/v1/me/info/reddit</code></li>
            <li><strong>User Profile:</strong> <code>/api/v1/social/reddit/u/spez</code></li>
            <li><strong>Subreddit Data:</strong> <code>/api/v1/social/reddit/r/programming</code></li>
          </ul>
          
          <div class="code-examples mt-3">
            <h6>Example curl commands:</h6>
            <div class="code-block mb-2">
              <pre><code>curl -q -LSsf <%= baseUrl %>/api/v1/me/info/reddit</code></pre>
            </div>
            <div class="code-block mb-2">
              <pre><code>curl -q -LSsf <%= baseUrl %>/api/v1/social/reddit/u/spez</code></pre>
            </div>
            <div class="code-block mb-2">
              <pre><code>curl -q -LSsf <%= baseUrl %>/api/v1/social/reddit/r/programming</code></pre>
            </div>
          </div>
          <a href="/api/v1/me/info/reddit" class="btn btn-info btn-sm" target="_blank">
            <i class="bi bi-box-arrow-up-right"></i> View Full Profile Data (JSON)
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.reddit-profile {
  padding: 1rem;
}

/* Profile Header with Avatar */
.profile-header {
  display: flex;
  gap: 1.5rem;
  align-items: flex-start;
  margin-bottom: 1.5rem;
  padding-bottom: 1.5rem;
  border-bottom: 2px solid var(--border-color);
}

.profile-avatar {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  border: 4px solid var(--purple);
  object-fit: cover;
  flex-shrink: 0;
}

.profile-info {
  flex: 1;
}

.profile-info h4 {
  color: var(--purple);
  margin-bottom: 0.5rem;
  font-size: 1.75rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.profile-info h4 i {
  font-size: 1.25rem;
}

.profile-description {
  color: var(--text-primary);
  line-height: 1.6;
  margin-top: 0.75rem;
}

/* Account Info Section */
.account-info {
  background: var(--bg-secondary);
  padding: 1rem;
  border-radius: var(--radius-md);
  border: 1px solid var(--border-color);
  margin-bottom: 1.5rem;
}

.info-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.5rem 0;
  border-bottom: 1px solid var(--border-color);
}

.info-row:last-child {
  border-bottom: none;
  padding-bottom: 0;
}

.info-row:first-child {
  padding-top: 0;
}

.info-label {
  color: var(--text-secondary);
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.info-value {
  color: var(--text-primary);
  font-weight: 500;
}

/* Karma Stats Grid */
.reddit-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 1rem;
  margin: 1.5rem 0;
}

.stat-card {
  background: var(--bg-secondary);
  padding: 1rem;
  border-radius: var(--radius-md);
  text-align: center;
  border: 1px solid var(--border-color);
  transition: transform 0.2s, box-shadow 0.2s;
}

.stat-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.stat-card.total {
  background: linear-gradient(135deg, var(--purple) 0%, var(--cyan) 100%);
  border: none;
  grid-column: span 2;
}

.stat-card.total .stat-number {
  color: white;
  font-size: 2rem;
}

.stat-card.total .stat-label {
  color: rgba(255, 255, 255, 0.9);
  font-weight: 700;
}

.stat-number {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--cyan);
}

.stat-label {
  font-size: 0.875rem;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-top: 0.25rem;
}

/* Profile Banner */
.profile-banner {
  margin: 1.5rem 0;
  border-radius: var(--radius-md);
  overflow: hidden;
  border: 2px solid var(--border-color);
}

.banner-img {
  width: 100%;
  height: auto;
  max-height: 300px;
  object-fit: cover;
  display: block;
}

/* API Info Section */
.reddit-info {
  background: rgba(139, 69, 233, 0.1);
  padding: 1rem;
  border-radius: var(--radius-md);
  border-left: 4px solid var(--purple);
}

.reddit-info p {
  margin-bottom: 0.75rem;
}

.info-badges {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.info-badges .badge {
  padding: 0.375rem 0.75rem;
  font-size: 0.875rem;
  font-weight: 600;
}

/* Loading and Error States */
.loading-state,
.error-state {
  text-align: center;
  padding: 2rem;
}

.loading-state {
  color: var(--text-secondary);
}

.error-state {
  color: var(--red);
}

/* Responsive Design */
@media (max-width: 768px) {
  .profile-header {
    flex-direction: column;
    align-items: center;
    text-align: center;
  }

  .profile-avatar {
    width: 100px;
    height: 100px;
  }

  .profile-info h4 {
    justify-content: center;
    font-size: 1.5rem;
  }

  .stat-card.total {
    grid-column: span 1;
  }

  .info-row {
    flex-direction: column;
    gap: 0.25rem;
    align-items: flex-start;
  }

  .reddit-stats {
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  }
}
</style>